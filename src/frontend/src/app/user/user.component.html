<section class="section pb-0">
   <div class="container">
      <div style="text-align:center">
        <h1>
          Friends
        </h1>
      </div>
      <router-outlet></router-outlet>
      <div class="card">
        <header class="card-header">
          <p class="card-header-title">Search New Friends</p>
        </header>
        <div class="card-content">
          <form #searchForm="ngForm" (ngSubmit)="searchUsers()">
            <div class="field has-addons">
                <div class="control has-icons-left has-icons-right is-expanded">
                    <input type="text" class="input" id="searchTerm" name="searchTerm" [(ngModel)]="searchTerm" placeholder="Search User by Name" required>
                </div>
                <p class="control">
                    <button type="submit" class="button is-info">Search</button>
                </p>
            </div>
          </form>
          <table *ngIf="searchSource && searchSource.length > 0">
            <tbody>
              <tr *ngFor="let user of searchSource" class="search-friends-table">
                <td>{{ user.name }}</td>
                <td class="search-table-second-col"><button type="button" class="button is-small is-primary" (click)="addFriend(user)">Add friend</button></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <br><br>
      <div class="card">
        <header class="card-header">
          <p class="card-header-title">My Friends List</p>
        </header>
        <div class="card-content">
          <table class="table is-striped is-hoverable friends-table">
            <thead>
              <tr>
                <th>On</th>
                <th>Avatar</th>
                <th>Name</th>
                <th>Score</th>
                <th>Played</th>
                <th>Wins</th>
                <th>Losses</th>
                <th>Playing</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let user of dataSource | async">
                <td class="has-text-centered">
                  <ng-container *ngIf="user.is_online; else offline">
                    <i class="fas fa-circle" style="color: #48c78e;"></i>
                  </ng-container>
                  <ng-template #offline>
                    <i class="fas fa-circle" style="color: #f44336;"></i>
                  </ng-template>
                </td>
                <td class="has-text-centered"><img class="is-rounded" [src]="user.avatar ? 'http://crazy-pong.com:3000/avatar/' + user.avatar : 'assets/avatar.jpg'" class="avatar-table"></td>
                <td>{{user.name}}</td>
                <td class="has-text-centered">{{user.score}}</td>
                <td class="has-text-centered">{{user.played}}</td>
                <td class="has-text-centered">{{user.wins}}</td>
                <td class="has-text-centered">{{user.losses}}</td>
                <td class="has-text-centered">
                  {{ user.is_playing == 0 ? 'No' : '' }}
                  <a *ngIf="user.is_playing != 0" routerLink="/game/match/{{user.is_playing}}">In play</a>
                </td>
                <td>
                  <a class="button is-small is-primary friend-option" [routerLink]="['/profiles', user.id]"><span class="icon is-small"><i class="fas fa-eye"></i></span></a>
                  <button class="button is-small is-danger friend-option" (click)="removeFriend(user.id)"><span class="icon is-small"><i class="fas fa-times"></i></span></button>
                  <!-- <button class="button is-info" (click)="selectUser(user)">Select User</button> -->
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
  </div>
</section>