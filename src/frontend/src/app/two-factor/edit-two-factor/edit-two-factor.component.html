<section class="section">
  <div class="container">
    <h1 class="title">Security Settings</h1>
    <div class="card">
      <div class="card-content">
        <div *ngIf="twoFactorActivated; else notActivated">
          Two factor activated
          <div class="field">
            <button (click)="unsetTwoFactor()" class="button is-primary">Disable Two Factor Auth</button>
          </div>
        </div>

        <ng-template #notActivated>
          Two factor deactivated
<!--           <button (click)="generateTwoFactor()">Generate Two Factor</button>
          <div *ngIf="twoFactorSecret">{{ twoFactorSecret }}</div> -->
          <div class="field">
            <div class="notification is-info" style="margin: 20px; display: inline-table;">
              To can use, the two factor auth, you need to have/download Google Authentificator App. Scan the QR, and sumbit in the form the Code that Google Authentificator App will generate.
            </div>
            <label class="label">Scan Google Auth QR:</label>
            <div class="control">
              <button (click)="generateTwoFactor()" class="button is-primary">Generate QR</button>
                <div id="QR"></div>
            </div>
            <label class="label">Confirm the code:</label>
            <div class="control">
              <input type="text" [(ngModel)]="code" name="code" placeholder="Enter Code" class="form-control input" required>
                <div *ngIf="input_error" class="help is-danger">{{ input_error }}</div>
            </div>
          </div>
          <div class="field">
            <button (click)="verifyTwoFactor()" class="button is-primary">Verify Two Factor</button>
          </div>
        </ng-template>
      </div>
    </div>
  </div>
</section>

